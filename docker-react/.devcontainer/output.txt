=== Directory Structure ===
.
├── Makefile
├── devcontainer.json
├── docker-compose.yml
├── infra
│   └── docker
│       └── volta
│           └── Dockerfile
└── output.txt

4 directories, 5 files


=== File Contents ===


```infra/docker/volta/Dockerfile
FROM ubuntu:22.04

ARG PKG="curl ca-certificates locales sudo"
ARG USER_NAME
ARG GROUP_NAME
ARG UID
ARG GID
ARG TZ
ARG WORKDIR
ARG VOLTA_HOME

RUN mkdir -p ${WORKDIR}
WORKDIR ${WORKDIR}

ENV TZ=${TZ}

RUN apt-get update && \
    apt-get install -y --no-install-recommends ${PKG} && \
    rm -rf /var/lib/apt/lists/*

# 任意: ユーザー作成
RUN groupadd -g ${GID} ${GROUP_NAME} && \
    useradd -lm -s /bin/bash -u ${UID} -g ${GID} -G sudo ${USER_NAME} && \
    echo "${USER_NAME}:password" | chpasswd && \
    echo "${USER_NAME} ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers
USER ${USER_NAME}

# Voltaインストール
RUN curl https://get.volta.sh | bash
ENV VOLTA_HOME=${VOLTA_HOME}
ENV PATH=$VOLTA_HOME/bin:$PATH

# Node.js / npm インストール
RUN volta install node npm

```


```Makefile
include .env
export $(shell sed 's/=.*//' .env)

DOCKER_COMPOSE_FILE_PATH=-f docker-compose.yml
ENV_PATH=--env-file .env
PROJECT_FLAG=--project-name ${PROJECT_NAME}_devcontainer
USER_FLAG=--user ${USER_NAME}

up:
	docker compose ${DOCKER_COMPOSE_FILE_PATH} ${ENV_PATH} up -d --build
down:
	docker compose ${DOCKER_COMPOSE_FILE_PATH} ${ENV_PATH} down
exec:
	docker compose ${DOCKER_COMPOSE_FILE_PATH} exec ${USER_FLAG} workspace bash
destroy:
	docker-compose ${DOCKER_COMPOSE_FILE_PATH} down --rmi all --volumes --remove-orphans
logs:
	docker compose ${DOCKER_COMPOSE_FILE_PATH} logs -f


```
[.env.template はバイナリファイルのため省略]
[.env はバイナリファイルのため省略]


```docker-compose.yml
version: "3"

services:
  workspace:
    container_name: ${PROJECT_NAME:-default}-vscode
    hostname: ${PROJECT_NAME:-default}
    build:
      context: ..
      dockerfile: .devcontainer/infra/docker/volta/Dockerfile
      args:
        USER_NAME: ${USER_NAME-myzn}
        GROUP_NAME: ${GROUP_NAME-myzn}
        UID: ${UID-1000}
        GID: ${GID-1000}
        PROJECT_DIR: ${PROJECT_DIR-..}
        WORKDIR: ${WORKDIR}
        VOLTA_HOME: ${VOLTA_HOME}
    working_dir: ${WORKDIR}
    tty: true
    restart: always
    env_file:
      - .env
    volumes:
      - type: bind
        source: ../
        target: ${WORKDIR-/home/$USER_NAME/app}
    ports:
      - target: 3000
        published: ${WEB_PUBLISHED_PORT:-3000}
        protocol: tcp
        mode: host
      - target: 5555
        published: ${PRISMA_STUDIO_PUBLISHED_PORT:-5555}
        protocol: tcp
        mode: host
    environment:
      - TZ=Asia/Tokyo
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3000"]
      interval: 30s
      timeout: 10s
      retries: 3
```


```devcontainer.json
{
    "name": "react container",                    // VScodeがコンテナに接続したときのタイトルを自由に設定
    "dockerComposeFile": "docker-compose.yml",  // docker-conpose.ymlファイルを指定
    "service": "react",                        // docker-conpose.ymlファイル内に記載したサービス名を指定
    "workspaceFolder": "/usr/src/app",         // VScode接続時に開くフォルダを指定
    "customizations": {
        "vscode": {
            "extensions": [
                // Basic
                "WakaTime.vscode-wakatime",
                "oderwat.indent-rainbow",
                "streetsidesoftware.code-spell-checker",
                "vscodevim.vim",
                "esbenp.prettier-vscode",
                "Gruntfuggly.todo-tree",
                "eamodio.gitlens",
                "mikestead.dotenv",
                "GitHub.vscode-github-actions",
                // HTML
                "bradgashler.htmltagwrap",
                "formulahendry.auto-rename-tag",
                "formulahendry.auto-close-tag",
                "ecmel.vscode-html-css",
                // CSS
                "pranaygp.vscode-css-peek",
                "Zignd.html-css-class-completion",
                "naumovs.color-highlight",
                // JS
                "WallabyJs.quokka-vscod",
                "sketchbuch.vsc-quokka-statusbar",
                "xabikos.JavaScriptSnippets",
                // React
                "dsznajder.es7-react-js-snippets",
                "biomejs.biome",
                "Prisma.prisma",
                "bradlc.vscode-tailwindcss"
            ]
        }
    }
}
```
